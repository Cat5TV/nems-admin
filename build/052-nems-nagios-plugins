#!/bin/bash

  # Dependencies
    # CISCO
    apt -y install libnet-snmp-perl snmp
    # WMIC
    apt -y install libdatetime-timezone-perl

  # Setup an interpreter for notify-by-pushover (and possibly others... prevents problems)
  if [[ ! -f /usr/local/bin/php ]]; then
    if [[ -f /usr/bin/php ]]; then
      ln -s /usr/bin/php /usr/local/bin/php
    fi
  fi

  # Grab the Migrator plugins
    cp -f /root/nems/nems-migrator/data/1.5/nagios/plugins/* /usr/local/nagios/libexec/

  # Add backward compatibility for notify-by-telegram (in case user has NEMS 1.3-1.4 config)
    if [[ -f /usr/local/bin/telegram_nems.lua ]]; then
      rm -f /usr/local/bin/telegram_nems.lua
    fi
    ln -s /usr/local/nagios/libexec/notify-by-telegram.lua /usr/local/bin/telegram_nems.lua


